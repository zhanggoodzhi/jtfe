{"version":3,"sources":["webpack:///./pages/superadmin/apis/index/index.ts"],"names":[],"mappings":"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","file":"69.js","sourcesContent":["// import 'select2/dist/css/select2.css';\r\nimport * as utils from 'utils';\r\nimport 'new-table';\r\nimport * as tables from 'tables';\r\nimport 'select';\r\n// import 'script-loader!select2/dist/js/select2.full.min.js';\r\nnamespace SuperadminApisIndex {\r\n\tdeclare const appList;\r\n\tenum action {\r\n\t\tupdate,\r\n\t\tadd\r\n\t}\r\n\tlet state: action;\r\n\t$(initTable);\r\n\tfunction initTable() {\r\n\t\tconst $appList = $('.appid');\r\n\t\t$appList.select2({\r\n\t\t\tdata: appList,\r\n\t\t\tplaceholder: '选择应用名称',\r\n\t\t\tallowClear: true\r\n\t\t});\r\n\t\t$appList.val('').trigger('change');\r\n\t\t$('#table').DataTable(Object.assign(tables.commonConfig(),\r\n\t\t\t{\r\n\t\t\t\tajax: {\r\n\t\t\t\t\turl: 'superadmin/apis/list',\r\n\t\t\t\t\ttype: 'POST',\r\n\t\t\t\t\tdataSrc: data => data.rows,\r\n\t\t\t\t\tdata: data => {\r\n\t\t\t\t\t\treturn utils.cleanObject({\r\n\t\t\t\t\t\t\tpage: tables.getPage(data),\r\n\t\t\t\t\t\t\trows: data.length,\r\n\t\t\t\t\t\t\tapiName: $('#apiName').val(),\r\n\t\t\t\t\t\t\tapiDesc: $('#apiDesc').val(),\r\n\t\t\t\t\t\t\tapiUrl: $('#apiUrl').val(),\r\n\t\t\t\t\t\t\tappid: $('#appid option:selected').val()\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tcolumns: [\r\n\t\t\t\t\t{ data: 'apiName', title: '名称' },\r\n\t\t\t\t\t{ data: 'apiDesc', title: '描述', render: (text) => text ? text : '无' },\r\n\t\t\t\t\t{ data: 'apiUrl', title: '链接' },\r\n\t\t\t\t\t{ data: 'appName', title: '应用名称' }\r\n\t\t\t\t],\r\n\t\t\t\tinitComplete: initComplete\r\n\t\t\t}\r\n\t\t));\r\n\t}\r\n\r\n\tfunction initComplete() {\r\n\t\tconst table = $('#table').DataTable();\r\n\t\t// 回车查询\r\n\t\tutils.bindEnter($('#apiName,#apiDesc,#apiUrl'), () => {\r\n\t\t\ttable.draw();\r\n\t\t});\r\n\t\t// 查询功能\r\n\t\t$('#apis-search-btn').on('click', () => {\r\n\t\t\ttable.draw();\r\n\t\t});\r\n\r\n\t\ttables.bindPageChange(table); // 绑定修改分页\r\n\t\tconst modalRoot = $('.apis');\r\n\t\t// 编辑功能\r\n\t\tlet editId;\r\n\t\t$('#apis-edit-btn').on('click', () => {\r\n\t\t\tstate = action.update;\r\n\t\t\ttables.checkLength({\r\n\t\t\t\taction: '编辑',\r\n\t\t\t\tname: 'API信息',\r\n\t\t\t\tunique: true,\r\n\t\t\t\ttable: table,\r\n\t\t\t\tcb: (data, row) => {\r\n\t\t\t\t\teditId = data.id;\r\n\t\t\t\t\tmodalRoot.find('.apiName').val(data.apiName);\r\n\t\t\t\t\tmodalRoot.find('.apiDesc').val(data.apiDesc);\r\n\t\t\t\t\tmodalRoot.find('.apiUrl').val(data.apiUrl);\r\n\t\t\t\t\tappList.forEach(v => {\r\n\t\t\t\t\t\tif (v.text === data.appName) {\r\n\t\t\t\t\t\t\t$(modalRoot.find('.appid')).val(v.id).trigger('change');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tmodalRoot.find('.submit-btn').text('保存');\r\n\t\t\t\t\tmodalRoot.modal('show').find('.modal-title').text('修改API');\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t\t// 添加功能\r\n\t\t$('#apis-add-btn').on('click', () => {\r\n\t\t\tstate = action.add;\r\n\t\t\tmodalRoot.find('.submit-btn').text('添加');\r\n\t\t\tmodalRoot.modal('show').find('.modal-title').text('添加API');\r\n\t\t});\r\n\t\t// 提交功能\r\n\t\tmodalRoot.find('.submit-btn').on('click', function () {\r\n\t\t\tconst endLoading = utils.loadingBtn($(this));\r\n\t\t\t// 获取传给后台的值\r\n\t\t\tconst sendData = {\r\n\t\t\t\tapiName: $.trim(modalRoot.find('.apiName').val()),\r\n\t\t\t\tapiDesc: $.trim(modalRoot.find('.apiDesc').val()),\r\n\t\t\t\tapiUrl: $.trim(modalRoot.find('.apiUrl').val()),\r\n\t\t\t\tappid: $.trim(modalRoot.find('.appid option:selected').val())\r\n\t\t\t};\r\n\t\t\tlet actionUrl: string;\r\n\t\t\tif (state === action.add) {\r\n\t\t\t\tactionUrl = 'superadmin/apis/add';\r\n\t\t\t} else if (state === action.update) {\r\n\t\t\t\tactionUrl = 'superadmin/apis/update';\r\n\t\t\t\tObject.assign(sendData, { id: editId });\r\n\t\t\t}\r\n\t\t\t// 校验\r\n\t\t\tconst inputs = modalRoot.find('input').toArray();\r\n\t\t\tfor (let v of inputs) {\r\n\t\t\t\tconst name = $.trim($(v).parent().prev().text());\r\n\t\t\t\tif (name !== '描述' && !$(v).val()) {\r\n\t\t\t\t\tutils.alertMessage(name + '不能为空！');\r\n\t\t\t\t\tendLoading();\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (!modalRoot.find('.appid').val()) {\r\n\t\t\t\tutils.alertMessage('应用名称不能为空！');\r\n\t\t\t\tendLoading();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t// 传值给后台\r\n\t\t\t$.ajax({\r\n\t\t\t\turl: actionUrl,\r\n\t\t\t\ttype: 'POST',\r\n\t\t\t\tdata: sendData,\r\n\t\t\t\tsuccess: msg => {\r\n\t\t\t\t\tif (!msg.error) {\r\n\t\t\t\t\t\ttable.draw();\r\n\t\t\t\t\t\tmodalRoot.modal('hide');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tutils.alertMessage(msg.msg, !msg.error);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tendLoading();\r\n\t\t});\r\n\t\t// 模态框消失就清空模态框中的数据\r\n\t\tmodalRoot.on('hidden.bs.modal', () => {\r\n\t\t\tconst inputs = modalRoot.find('input').toArray();\r\n\t\t\tfor (let v of inputs) {\r\n\t\t\t\t$($(v).val(''));\r\n\t\t\t}\r\n\t\t\tmodalRoot.find('.appid').val('').trigger('change');\r\n\t\t});\r\n\t\t// 删除功能\r\n\t\ttables.delBtnClick({\r\n\t\t\tel: $('#apis-del-btn'),\r\n\t\t\ttable: table,\r\n\t\t\tname: 'API信息',\r\n\t\t\turl: 'superadmin/apis/delete'\r\n\t\t});\r\n\t}\r\n}\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./pages/superadmin/apis/index/index.ts"],"sourceRoot":""}