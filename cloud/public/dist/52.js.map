{"version":3,"sources":["webpack:///./pages/knowledge/qaOnDocument/index/index.ts","webpack:///./pages/knowledge/qaOnDocument/index/index.less"],"names":[],"mappings":"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","file":"52.js","sourcesContent":["import * as utils from 'utils';\r\nimport './index.less';\r\nimport { Upload } from 'upload';\r\nimport { Table } from 'new-table';\r\nimport 'time';\r\n\r\nlet selected: {\r\n\tappId: number;\r\n\tcreateTime: number;\r\n\tdocumentName: string;\r\n\tdocumentSize: string;\r\n\tdocumentSystemName: string;\r\n\tdocumentType: string;\r\n\tid: number;\r\n};\r\n\r\n$(() => {\r\n\tutils.bindEnter($('#question'), () => {\r\n\t\t$('#ask-btn').trigger('click');\r\n\t});\r\n\t// initText();\r\n\tinitDoc();\r\n});\r\n\r\n/*function initText() {\r\n    $('#ask-btn').on('click', () => {\r\n        const documentVal = $.trim($('#document').val()),\r\n            questionVal = $.trim($('#question').val());\r\n        if (documentVal === '') {\r\n            utils.alertMessage('请填写文档内容');\r\n        }\r\n        else if (questionVal === '') {\r\n            utils.alertMessage('请填写测试问题');\r\n        }\r\n        else {\r\n            const endLoading = utils.loadingBtn($('#ask-btn'));\r\n            $.ajax({\r\n                url: 'knowledge/qaOnDocument/query',\r\n                type: 'POST',\r\n                data: {\r\n                    content: documentVal,\r\n                    question: questionVal\r\n                },\r\n                success: renderAnswer,\r\n                complete: () => {\r\n                    endLoading();\r\n                }\r\n            });\r\n        }\r\n    });\r\n}*/\r\n\r\n\r\nfunction initDoc() {\r\n\tconst table = new Table({\r\n\t\tel: $('#select-doc-table'),\r\n\t\toptions: {\r\n\t\t\tajax: {\r\n\t\t\t\turl: 'knowledge/qaOnDocument/list',\r\n\t\t\t\tdataSrc: (d) => d.rows,\r\n\t\t\t\tdata: (d: any) => {\r\n\t\t\t\t\treturn utils.cleanObject({\r\n\t\t\t\t\t\tdocumentName: $('#doc-name-search').val().trim(),\r\n\t\t\t\t\t\tpage: Math.floor((d.start + d.length) / d.length),\r\n\t\t\t\t\t\trows: d.length\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tselect: {\r\n\t\t\t\tstyle: 'single'\r\n\t\t\t},\r\n\t\t\tserverSide: true,\r\n\t\t\tscrollY: window.innerHeight * 0.4 + 'px',\r\n\t\t\tpaging: true,\r\n\t\t\tcolumns: [\r\n\t\t\t\t{ data: 'documentName', title: '文档名称' },\r\n\t\t\t\t{\r\n\t\t\t\t\tdata: 'createTime', title: '上传时间', width: '140px', render: (time: number) => {\r\n\t\t\t\t\t\treturn moment(time).format('YYYY-MM-DD HH:mm:ss');\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t}\r\n\t}),\r\n\t\tt = table.dt;\r\n\r\n\tnew Upload({\r\n\t\tbtn: $('#upload-doc'),\r\n\t\taccept: '.txt,.doc,.docx,.pdf,.xls,.xlsx',\r\n\t\turl: 'knowledge/qaOnDocument/upload',\r\n\t\tname: 'attach',\r\n\t\tloading: true,\r\n\t\toption: {\r\n\t\t\tmultiple: false\r\n\t\t},\r\n\t\tsuccess: (id, name, res) => {\r\n\t\t\tif (!res.error) {\r\n\t\t\t\tupdateSelectedDoc(res.data);\r\n\t\t\t} else {\r\n\t\t\t\tutils.alertMessage(res.msg, !res.error);\r\n\t\t\t}\r\n\t\t}\r\n\t}).uploader;\r\n\r\n\t$('#ask-btn').on('click', () => {\r\n\t\tif (!selected) {\r\n\t\t\tutils.alertMessage('请选择文档');\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst question = $('#question').val().trim();\r\n\r\n\t\tif (question === '') {\r\n\t\t\tutils.alertMessage('请填写测试问题');\r\n\t\t}\r\n\t\telse {\r\n\t\t\tconst end = utils.loadingBtn($('#ask-btn'));\r\n\t\t\t$.ajax('knowledge/qaOnDocument/analysis', {\r\n\t\t\t\tmethod: 'POST',\r\n\t\t\t\tdata: {\r\n\t\t\t\t\tquestion: question,\r\n\t\t\t\t\tid: selected.id\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t\t.done((res) => {\r\n\t\t\t\t\trenderAnswer(res);\r\n\t\t\t\t})\r\n\t\t\t\t.always(() => {\r\n\t\t\t\t\tend();\r\n\t\t\t\t});\r\n\t\t}\r\n\t});\r\n\r\n\r\n\t$('#doc-search-btn').on('click', () => {\r\n\t\tt.draw();\r\n\t});\r\n\r\n\t$('#select-doc').on('click', () => {\r\n\t\t$('#select-doc-modal').modal('show');\r\n\t\tt.draw();\r\n\t});\r\n\r\n\t$('#select-doc-modal').one('shown.bs.modal', () => {\r\n\t\tt.columns.adjust();\r\n\t});\r\n\r\n\t$('#select-doc-btn').on('click', () => {\r\n\t\tconst s = t.row({ selected: true }).data();\r\n\t\tif (!s) {\r\n\t\t\tutils.alertMessage('请选择文档');\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tupdateSelectedDoc(s);\r\n\t\t$('#select-doc-modal').modal('hide');\r\n\r\n\t});\r\n\r\n\r\n\tutils.bindEnter($('#doc-name-search'), () => {\r\n\t\tt.draw();\r\n\t});\r\n}\r\n\r\nfunction renderAnswer(res) {\r\n\tlet html: string = '';\r\n\tif (!res.error && res.data) {\r\n\t\tconst answers = res.data.slice(0, 3);\r\n\t\tif (answers.length <= 0) {\r\n\t\t\thtml = '未找到合适的答案';\r\n\t\t} else {\r\n\t\t\thtml = answers.map((text: string, index) => {\r\n\t\t\t\treturn `\r\n\t\t\t\t<p>回复${index + 1}：</p>\r\n\t\t\t\t<p>${text.replace(/\\n+/g, '<br/>')}</p>`;\r\n\t\t\t}).join('');\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tutils.alertMessage(res.msg, !res.error);\r\n\t}\r\n\t$('#answer').html(html);\r\n}\r\n\r\n\r\nfunction updateSelectedDoc(data) {\r\n\tselected = data;\r\n\t$('#doc-name').text(data.documentName);\r\n}\r\n\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./pages/knowledge/qaOnDocument/index/index.ts","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./pages/knowledge/qaOnDocument/index/index.less\n// module id = 929\n// module chunks = 52"],"sourceRoot":""}