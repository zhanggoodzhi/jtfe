{"version":3,"sources":["webpack:///./pages/weixinv2/group/index/index.ts","webpack:///./pages/weixinv2/group/index/index.less"],"names":[],"mappings":"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","file":"32.js","sourcesContent":["import './index.less';\r\nimport 'new-table';\r\nimport { alertMessage, loadingBtn } from 'utils';\r\nimport * as tables from 'tables';\r\nnamespace Weixinv2Index {\r\n\tlet table: DataTables.Api;\r\n\tlet t: tables.Table;\r\n\t$(() => {\r\n\t\tconst btn = $('#sync-btn'),\r\n\t\t\taccount = $('#weixin-account');\r\n\t\tinitTable();\r\n\t\taccount.on('change', (e) => {\r\n\t\t\tconst val = $(e.currentTarget).val();\r\n\t\t\tif (val === '') {\r\n\t\t\t\tbtn.prop('disabled', 'true');\r\n\t\t\t} else {\r\n\t\t\t\tbtn.prop('disabled', '');\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n\r\n    /**\r\n     * 初始化表格\r\n     */\r\n\tfunction initTable() {\r\n\t\ttable = $('#table').DataTable(\r\n\t\t\tObject.assign(\r\n\t\t\t\ttables.commonConfig(),\r\n\t\t\t\t{\r\n\t\t\t\t\tselect: false,\r\n\t\t\t\t\tajax: {\r\n\t\t\t\t\t\turl: 'weixinv2/group/listUser',\r\n\t\t\t\t\t\ttype: 'GET',\r\n\t\t\t\t\t\tdata: (data) => {\r\n\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\tpage: tables.getPage(data),\r\n\t\t\t\t\t\t\t\trows: data.length,\r\n\t\t\t\t\t\t\t\tcredentialId: $('#weixin-account').val(),\r\n\t\t\t\t\t\t\t\tgroupId: $('#weixin-group').val()\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tdataSrc: data => data.rows\r\n\t\t\t\t\t},\r\n\t\t\t\t\tinitComplete: initComplete,\r\n\t\t\t\t\tcolumns: [\r\n\t\t\t\t\t\t{ data: 'key.headimgurl', title: '头像', render: renderImg },\r\n\t\t\t\t\t\t{ data: 'key.credential.wxName', title: '公众号' },\r\n\t\t\t\t\t\t{ data: 'key.nickname', title: '昵称', createdCell: tables.createAddTitle },\r\n\t\t\t\t\t\t{ data: 'value', title: '分组' },\r\n\t\t\t\t\t\t{ data: 'key.city', title: '城市' }\r\n\t\t\t\t\t]\r\n\t\t\t\t}\r\n\t\t\t)\r\n\t\t);\r\n\t\tt = new tables.Table(table);\r\n\t}\r\n\tfunction renderImg(text) {\r\n\t\treturn '<img src=\"' + text + '\" class=\"head-img\" alt=\"头像\"/>';\r\n\t}\r\n    /**\r\n     *\r\n     *\r\n     * @param {HTMLElement} that\r\n     * @returns\r\n     */\r\n\tfunction selectChange(that: HTMLElement) {\r\n\t\tconst group = $('#weixin-group'),\r\n\t\t\taccount = $(that);\r\n\t\tgroup.empty();\r\n\t\tgroup.append('<option value=\"\" >全部分组</option>');\r\n\t\tif (!account.val()) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t$.ajax({\r\n\t\t\turl: 'weixinv2/group/listGroup',\r\n\t\t\ttype: 'GET',\r\n\t\t\tdata: {\r\n\t\t\t\tcredentialId: account.val()\r\n\t\t\t},\r\n\t\t\tsuccess: function (data) {\r\n\t\t\t\tconst d = data.rows;\r\n\t\t\t\td.forEach(function (value, index) {\r\n\t\t\t\t\tgroup.append('<option value=' + value.id + ' >' + value.name + '</option>');\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\tfunction initComplete() {\r\n\t\tconst btn = $('#sync-btn'),\r\n\t\t\taccount = $('#weixin-account');\r\n\r\n\t\t$('#search-btn').on('click', function () {\r\n\t\t\t// if (!$('#weixin-account').val() && $('#weixin-group').val()) {\r\n\t\t\t//     return;\r\n\t\t\t// }\r\n\t\t\t// table.draw();\r\n\t\t\tt.refresh(true);\r\n\t\t});\r\n\t\t$('#weixin-account').on('change', function () {\r\n\t\t\tselectChange(this);\r\n\t\t});\r\n\r\n\t\tbtn.on('click', () => {\r\n\t\t\tconst end = loadingBtn(btn);\r\n\t\t\t$.ajax('weixinv2/resyncUserAndGroup', {\r\n\t\t\t\tmethod: 'POST',\r\n\t\t\t\tdata: {\r\n\t\t\t\t\tcredentialId: account.val()\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t\t.done(res => {\r\n\t\t\t\t\talertMessage(res.msg, !res.error);\r\n\t\t\t\t\tif (!res.error) {\r\n\t\t\t\t\t\ttable.draw();\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t.always(() => {\r\n\t\t\t\t\tend();\r\n\t\t\t\t});\r\n\t\t});\r\n\t\ttables.bindPageChange(table, $('#page-change'));\r\n\t}\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./pages/weixinv2/group/index/index.ts","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./pages/weixinv2/group/index/index.less\n// module id = 967\n// module chunks = 32"],"sourceRoot":""}