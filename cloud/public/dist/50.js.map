{"version":3,"sources":["webpack:///./pages/knowledge/trainning/index.ts","webpack:///./pages/knowledge/trainning/index.less"],"names":[],"mappings":"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","file":"50.js","sourcesContent":["import * as utils from 'utils';\r\nimport './index.less';\r\nimport 'time';\r\nnamespace KnowledgeTrainning {\r\n\tdeclare const appId: string;\r\n\tlet ifStop = false;\r\n\tlet ifFirst = true;\r\n\tinterface IResData {\r\n\t\tstatus: number;\r\n\t\tstatusValue: string;\r\n\t\tprogress: number;\r\n\t\tcreateTime?: string;\r\n\t}\r\n\r\n\t$(init);\r\n\r\n\tfunction init() {\r\n\r\n\t\tif (!appId) {\r\n\t\t\tutils.alertMessage('获取appId失败错误');\r\n\t\t} else {\r\n\t\t\tgetTrainStatus((data: IResData) => {\r\n\t\t\t\tswitch (data.status) {\r\n\t\t\t\t\t// 载入后第一次查询如果为成功则为未开始\r\n\t\t\t\t\tcase 1:\r\n\t\t\t\t\t\trenderProgressBar({\r\n\t\t\t\t\t\t\tstatus: -1,\r\n\t\t\t\t\t\t\tstatusValue: `上次训练成功,训练时间为 <b>${data.createTime}</b>`,\r\n\t\t\t\t\t\t\tprogress: 0\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 2:\r\n\t\t\t\t\t\trenderProgressBar(data);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tgetTrainStatus();\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t$('#experience-btn').on('click', (e) => {\r\n\t\t\t\t\tlocation.assign($(e.currentTarget).data('href'));\r\n\t\t\t\t});\r\n\r\n\t\t\t\t$('#start-btn').on('click', train);\r\n\t\t\t\t$('#end-btn').on('click', stop);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\tfunction stop() {\r\n\t\tutils.confirmModal({\r\n\t\t\tmsg: `终止后此次训练不生效，您确认要终止训练吗?`,\r\n\t\t\ttext: '确定',\r\n\t\t\tcb: (modal, btn) => {\r\n\t\t\t\tconst loading = utils.loadingBtn(btn);\r\n\t\t\t\t$.ajax({\r\n\t\t\t\t\turl: 'train/stopTrain',\r\n\t\t\t\t\tmethod: 'GET'\r\n\t\t\t\t}).done((msg) => {\r\n\t\t\t\t\tif (!msg.error) {\r\n\t\t\t\t\t\tmodal.modal('hide');\r\n\t\t\t\t\t\tifStop = true;\r\n\t\t\t\t\t\tutils.alertMessage('正在终止训练', true);\r\n\t\t\t\t\t\t// renderProgressBar({\r\n\t\t\t\t\t\t// \tstatus: -1,\r\n\t\t\t\t\t\t// \tstatusValue: `训练终止`,\r\n\t\t\t\t\t\t// \tprogress: 0\r\n\t\t\t\t\t\t// });\r\n\t\t\t\t\t}\r\n\t\t\t\t}).always(() => {\r\n\t\t\t\t\tloading();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\tfunction getTrainStatus(cb?: Function) {\r\n\t\t$.ajax({\r\n\t\t\ttype: 'POST',\r\n\t\t\turl: 'train/status',\r\n\t\t\tdata: {\r\n\t\t\t\tappId: appId\r\n\t\t\t},\r\n\t\t\tsuccess: (res) => {\r\n\t\t\t\tif (res.error) {\r\n\t\t\t\t\tutils.alertMessage(res.msg, !res.error);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconst data: IResData = res.data;\r\n\t\t\t\t\tif (cb !== undefined) {\r\n\t\t\t\t\t\tcb(data);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\trenderProgressBar(data);\r\n\t\t\t\t\t\tif (data.status === 0) {\r\n\t\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\t\tgetTrainStatus(cb);\r\n\t\t\t\t\t\t\t}, 500);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\tfunction getLastSuccess(cb) {\r\n\t\t$.ajax({\r\n\t\t\ttype: 'GET',\r\n\t\t\turl: 'train/lastTrainSuccess',\r\n\t\t\tsuccess: (res) => {\r\n\t\t\t\tif (!res.data) {\r\n\t\t\t\t\tifFirst = false;\r\n\t\t\t\t}\r\n\t\t\t\tcb(utils.renderCommonTime(res.data.createTime));\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tfunction train(e: JQueryEventObject) {\r\n\t\tconst endLoading = utils.loadingBtn($(e.currentTarget));\r\n\t\t$.ajax({\r\n\t\t\turl: 'train/train',\r\n\t\t\ttype: 'POST',\r\n\t\t\tdata: {\r\n\t\t\t\tappId: appId\r\n\t\t\t},\r\n\t\t\tsuccess: (res) => {\r\n\t\t\t\tif (!res.error) {\r\n\t\t\t\t\t$('#start').hide();\r\n\t\t\t\t\tgetTrainStatus();\r\n\t\t\t\t\tutils.alertMessage('已经发起训练请求,您可以切换到其它页面进行其它操作,训练状态可以观察训练机器人进度下方显示的内容', true);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tutils.alertMessage(res.msg, !res.error, false);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tcomplete: () => {\r\n\t\t\t\tendLoading();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\r\n    /**\r\n     * 渲染进度条并控制按钮显示状态\r\n     *\r\n     * @param {IResData} data\r\n     */\r\n\tfunction renderProgressBar(data: IResData) {\r\n\t\tconst startBtn = $('#start-btn').hide(),\r\n\t\t\tendBtn = $('#end-btn'),\r\n\t\t\texperienceBtn = $('#experience-btn');\r\n\t\tswitch (data.status) {\r\n\t\t\tcase 0:\r\n\t\t\t\tstartBtn.hide();\r\n\t\t\t\tendBtn.show();\r\n\t\t\t\t$('#status-text').html(data.statusValue);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 1:\r\n\t\t\t\tutils.alertMessage('训练完成, 您现在可以打开访客界面重新感受一下经过训练升级后的智能客服', true);\r\n\t\t\t\tstartBtn.show();\r\n\t\t\t\texperienceBtn.show();\r\n\t\t\t\tendBtn.hide();\r\n\t\t\t\t$('#status-text').html(`训练成功,上次训练时间为${data.createTime}`);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 2:\r\n\t\t\t\tstartBtn.show();\r\n\t\t\t\tendBtn.hide();\r\n\r\n\t\t\t\t$('#progress-bar').width(0 * 100 + '%');\r\n\t\t\t\tif (ifStop) {\r\n\t\t\t\t\tutils.alertMessage('训练已终止，您可以重新开始训练！', true);\r\n\t\t\t\t\t$('#status-text').html('训练终止');\r\n\t\t\t\t\tifStop = false;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t$('#status-text').html(ifFirst ? '' : '训练失败');// 防止字段闪烁\r\n\t\t\t\t}\r\n\t\t\t\tif (ifFirst) {\r\n\t\t\t\t\tgetLastSuccess((time) => {\r\n\t\t\t\t\t\t$('#status-text').html(`训练成功,上次训练时间为${time}`);\r\n\t\t\t\t\t\tifFirst = false;\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\treturn;\r\n\t\t\tdefault:\r\n\t\t\t\tstartBtn.show();\r\n\t\t\t\tendBtn.hide();\r\n\t\t\t\t$('#status-text').html(data.statusValue);\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\t$('#progress-bar').width(data.progress * 100 + '%');\r\n\r\n\t}\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./pages/knowledge/trainning/index.ts","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./pages/knowledge/trainning/index.less\n// module id = 933\n// module chunks = 50"],"sourceRoot":""}