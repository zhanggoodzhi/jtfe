{"version":3,"sources":["webpack:///./pages/superadmin/fieldDictionary/index/index.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAAA,yCAAyC;AACzC,mCAA+B;AAC/B,uBAAmB;AACnB,qCAAiC;AACjC,8DAA8D;AAC9D,wBAAgB;AAEhB,IAAU,8BAA8B,CAgQvC;AAhQD,WAAU,8BAA8B;IACvC,IAAK,MAGJ;IAHD,WAAK,MAAM;QACV,iCAAG;QACH,uCAAM;IACP,CAAC,EAHI,MAAM,KAAN,MAAM,QAGV;IACD,IAAI,KAAa,CAAC;IAGlB,CAAC,CAAC,SAAS,CAAC,CAAC;IACb;QACC,IAAM,KAAK,GAAG,CAAC,CAAC,OAAO,CAAC,CAAC;QACzB,IAAM,QAAQ,GAAG,CAAC,CAAC,UAAU,CAAC,CAAC;QAC/B,KAAK,CAAC,OAAO,CAAC;YACb,IAAI,EAAE,KAAK;YACX,WAAW,EAAE,MAAM;YACnB,UAAU,EAAE,IAAI;SAChB,CAAC,CAAC;QACH,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;QAChC,QAAQ,CAAC,OAAO,CAAC;YAChB,GAAG,EAAE,MAAM;YACX,IAAI,EAAE,QAAQ;YACd,WAAW,EAAE,OAAO;YACpB,UAAU,EAAE,IAAI;SACT,CAAC,CAAC;QACV,QAAQ,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;QACtC,CAAC,CAAC,QAAQ,CAAC,CAAC,SAAS,CAAC,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC,YAAY,EAAE,EACxD;YACC,IAAI,EAAE;gBACL,GAAG,EAAE,iCAAiC;gBACtC,IAAI,EAAE,MAAM;gBACZ,OAAO,EAAE,cAAI,IAAI,WAAI,CAAC,IAAI,EAAT,CAAS;gBAC1B,IAAI,EAAE,cAAI;oBACT,MAAM,CAAC,KAAK,CAAC,WAAW,CAAC;wBACxB,IAAI,EAAE,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC;wBAC1B,IAAI,EAAE,IAAI,CAAC,MAAM;wBACjB,IAAI,EAAE,CAAC,CAAC,OAAO,CAAC,CAAC,GAAG,EAAE;wBACtB,IAAI,EAAE,CAAC,CAAC,uBAAuB,CAAC,CAAC,IAAI,EAAE;wBACvC,IAAI,EAAE,CAAC,CAAC,OAAO,CAAC,CAAC,GAAG,EAAE;wBACtB,aAAa,EAAE,CAAC,CAAC,+BAA+B,CAAC,CAAC,GAAG,EAAE;qBACvD,CAAC,CAAC;gBACJ,CAAC;aACD;YACD,OAAO,EAAE;gBACR,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,IAAI,EAAE;gBAC7B,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,IAAI,EAAE;gBAC7B,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,OAAO,EAAE;gBAChC,EAAE,IAAI,EAAE,aAAa,EAAE,KAAK,EAAE,IAAI,EAAE;gBACpC,EAAE,IAAI,EAAE,cAAc,EAAE,KAAK,EAAE,KAAK,EAAE,MAAM,EAAE,aAAa,EAAE;aAC7D;YACD,YAAY,EAAE,YAAY;SAC1B,CACD,CAAC,CAAC;QACH,uBAAuB,IAAI;YAC1B,IAAI,WAAW,CAAC;YAChB,QAAQ,CAAC,OAAO,CAAC,WAAC;gBACjB,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE,KAAK,IAAI,CAAC,CAAC,CAAC;oBACnB,WAAW,GAAG,CAAC,CAAC,IAAI,CAAC;gBACtB,CAAC;YACF,CAAC,CAAC,CAAC;YACH,MAAM,CAAC,WAAW,CAAC;QACpB,CAAC;IACF,CAAC;IACD;QACC,IAAM,KAAK,GAAG,CAAC,CAAC,QAAQ,CAAC,CAAC,SAAS,EAAE,CAAC;QACtC,KAAK,CAAC,SAAS,CAAC,CAAC,CAAC,mBAAmB,CAAC,EAAE;YACvC,KAAK,CAAC,IAAI,EAAE,CAAC;QACd,CAAC,CAAC,CAAC;QACH,OAAO;QACP,CAAC,CAAC,wBAAwB,CAAC,CAAC,EAAE,CAAC,OAAO,EAAE;YACvC,KAAK,CAAC,IAAI,EAAE,CAAC;QACd,CAAC,CAAC,CAAC;QACH,MAAM,CAAC,cAAc,CAAC,KAAK,CAAC,CAAC,CAAC,SAAS;QACvC,OAAO;QACP,IAAM,SAAS,GAAG,CAAC,CAAC,aAAa,CAAC,CAAC;QACnC,CAAC,CAAC,qBAAqB,CAAC,CAAC,EAAE,CAAC,OAAO,EAAE;YACpC,KAAK,GAAG,MAAM,CAAC,GAAG,CAAC;YACnB,SAAS,CAAC,IAAI,CAAC,mBAAmB,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAC/C,SAAS,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;YAC9D,SAAS,CAAC,SAAS,CAAC,CAAC;QACtB,CAAC,CAAC,CAAC;QACH,OAAO;QACP,IAAI,KAAa,CAAC;QAClB,CAAC,CAAC,sBAAsB,CAAC,CAAC,EAAE,CAAC,OAAO,EAAE;YACrC,KAAK,GAAG,MAAM,CAAC,MAAM,CAAC;YACtB,MAAM,CAAC,WAAW,CAAC;gBAClB,MAAM,EAAE,IAAI;gBACZ,IAAI,EAAE,MAAM;gBACZ,MAAM,EAAE,IAAI;gBACZ,KAAK,EAAE,KAAK;gBACZ,EAAE,EAAE,UAAC,IAAI;oBACR,KAAK,GAAG,IAAI,CAAC,EAAE,CAAC;oBAChB,OAAO,EAAE,CAAC,OAAO,CAAC,WAAC;wBAClB,IAAM,EAAE,GAAG,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;wBAChC,EAAE,CAAC,CAAC,CAAC,CAAC,IAAI,KAAK,eAAe,CAAC,CAAC,CAAC;4BAChC,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;wBAChD,CAAC;wBAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,IAAI,KAAK,MAAM,CAAC,CAAC,CAAC;4BAC9B,SAAS;4BACT,KAAK,CAAC,OAAO,CAAC,WAAC;gCACd,EAAE,CAAC,CAAC,CAAC,CAAC,IAAI,KAAK,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;oCAC7B,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;gCACnC,CAAC;4BACF,CAAC,CAAC,CAAC;wBACJ,CAAC;wBAAC,IAAI,CAAC,CAAC;4BACP,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC;wBACtB,CAAC;oBACF,CAAC,CAAC,CAAC;oBACH,SAAS,CAAC,IAAI,CAAC,mBAAmB,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;oBAC/C,SAAS,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;gBAC/D,CAAC;aACD,CAAC,CAAC;QACJ,CAAC,CAAC,CAAC;QACH,OAAO;QACP,CAAC,CAAC,aAAa,CAAC,CAAC,EAAE,CAAC,OAAO,EAAE;YAC5B,EAAE,CAAC,CAAC,KAAK,KAAK,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC;gBAC1B,WAAW,EAAE,CAAC;YACf,CAAC;YAAC,IAAI,CAAC,EAAE,CAAC,CAAC,KAAK,KAAK,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC;gBACpC,YAAY,EAAE,CAAC;YAChB,CAAC;QACF,CAAC,CAAC,CAAC;QACH,OAAO;QACP,MAAM,CAAC,WAAW,CAAC;YAClB,EAAE,EAAE,CAAC,CAAC,qBAAqB,CAAC;YAC5B,KAAK,EAAE,KAAK;YACZ,IAAI,EAAE,MAAM;YACZ,GAAG,EAAE,mCAAmC;SACxC,CAAC,CAAC;QAEH;YACC,IAAM,UAAU,GAAG,KAAK,CAAC,UAAU,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC;YAC7C,IAAM,QAAQ,GAAQ,SAAS,CAAC,SAAS,EAAE,KAAK,CAAC,CAAC;YAClD,QAAQ,CAAC,IAAI,GAAG,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;YACxC,EAAE,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC;gBACd,CAAC,CAAC,IAAI,CAAC;oBACN,GAAG,EAAE,gCAAgC;oBACrC,IAAI,EAAE,MAAM;oBACZ,IAAI,EAAE,QAAQ;oBACd,OAAO,EAAE,aAAG;wBACX,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC;4BAChB,KAAK,CAAC,IAAI,EAAE,CAAC;4BACb,SAAS,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;wBACzB,CAAC;wBACD,KAAK,CAAC,YAAY,CAAC,GAAG,CAAC,GAAG,EAAE,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;oBACzC,CAAC;iBACD,CAAC,CAAC;YACJ,CAAC;YACD,UAAU,EAAE,CAAC;QACd,CAAC;QACD;YACC,IAAM,UAAU,GAAG,KAAK,CAAC,UAAU,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC;YAC7C,IAAM,QAAQ,GAAG,SAAS,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;YAC9C,MAAM,CAAC,MAAM,CAAC,QAAQ,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE,CAAC,CAAC;YACvC,EAAE,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC;gBACd,CAAC,CAAC,IAAI,CAAC;oBACN,GAAG,EAAE,mCAAmC;oBACxC,IAAI,EAAE,MAAM;oBACZ,IAAI,EAAE,QAAQ;oBACd,OAAO,EAAE,aAAG;wBACX,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC;4BAChB,KAAK,CAAC,IAAI,EAAE,CAAC;4BACb,SAAS,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;4BACxB,SAAS,CAAC,SAAS,CAAC,CAAC;wBACtB,CAAC;wBACD,KAAK,CAAC,YAAY,CAAC,GAAG,CAAC,GAAG,EAAE,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;oBACzC,CAAC;iBACD,CAAC,CAAC;YACJ,CAAC;YACD,UAAU,EAAE,CAAC;QACd,CAAC;IACF,CAAC;IACD,iBAAiB,MAAe;QAC/B,IAAM,IAAI,GAAG;YACZ;gBACC,IAAI,EAAE,MAAM;gBACZ,EAAE,EAAE,OAAO;gBACX,OAAO,EAAE,IAAI;aACb;YACD;gBACC,IAAI,EAAE,MAAM;gBACZ,EAAE,EAAE,OAAO;gBACX,OAAO,EAAE,IAAI;aACb;YACD;gBACC,IAAI,EAAE,MAAM;gBACZ,EAAE,EAAE,OAAO;gBACX,OAAO,EAAE,IAAI;gBACb,OAAO,EAAE,eAAe;gBACxB,UAAU,EAAE,WAAW;aACvB,EAAE;gBACF,IAAI,EAAE,aAAa;gBACnB,EAAE,EAAE,cAAc;gBAClB,OAAO,EAAE,KAAK;aACd,EAAE;gBACF,IAAI,EAAE,eAAe;gBACrB,EAAE,EAAE,gBAAgB;gBACpB,OAAO,EAAE,IAAI;aACb;SACD,CAAC;QACF,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC;YACZ,IAAM,GAAC,GAAG,EAAE,CAAC;YACb,IAAI,CAAC,OAAO,CAAC,WAAC;gBACb,EAAE,CAAC,CAAC,MAAM,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;oBACrB,GAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;gBACX,CAAC;YACF,CAAC,CAAC,CAAC;YACH,MAAM,CAAC,GAAC,CAAC;QACV,CAAC;QACD,MAAM,CAAC,IAAI,CAAC;IACb,CAAC;IACD,mBAAmB,EAAE,EAAE,GAAG;QACzB,IAAI,WAAW,GAAG,EAAE,CAAC;QACrB,EAAE,CAAC,CAAC,GAAG,KAAK,KAAK,CAAC,CAAC,CAAC;YACnB,WAAW,GAAG,OAAO,EAAE,CAAC;QACzB,CAAC;QAAC,IAAI,CAAC,EAAE,CAAC,CAAC,GAAG,KAAK,MAAM,CAAC,CAAC,CAAC;YAC3B,WAAW,GAAG,OAAO,EAAE,CAAC;QACzB,CAAC;QACD,IAAI,QAAQ,GAAG,EAAE,CAAC;QAClB,GAAG,CAAC,CAAU,UAAW,EAAX,2BAAW,EAAX,yBAAW,EAAX,IAAW;YAApB,IAAI,CAAC;YACT,IAAI,GAAG,UAAC;YACR,IAAI,MAAI,UAAC;YACT,EAAE,CAAC,CAAC,CAAC,CAAC,IAAI,KAAK,MAAM,CAAC,CAAC,CAAC;gBACvB,GAAG,GAAG,EAAE,CAAC,IAAI,CAAC,uBAAuB,CAAC,CAAC,IAAI,EAAE,CAAC;gBAC9C,MAAI,GAAG,IAAI,CAAC;YACb,CAAC;YAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,IAAI,KAAK,eAAe,CAAC,CAAC,CAAC;gBACvC,GAAG,GAAG,EAAE,CAAC,IAAI,CAAC,0BAA0B,CAAC,CAAC,GAAG,EAAE,CAAC;gBAChD,MAAI,GAAG,KAAK,CAAC;YACd,CAAC;YAAC,IAAI,CAAC,CAAC;gBACP,IAAM,KAAK,GAAG,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;gBAC5B,GAAG,GAAG,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,EAAE,CAAC,CAAC;gBAC1B,MAAI,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,IAAI,EAAE,CAAC,IAAI,EAAE,CAAC;YACrC,CAAC;YACD,EAAE,CAAC,CAAC,CAAC,CAAC,OAAO,IAAI,GAAG,KAAK,EAAE,CAAC,CAAC,CAAC;gBAC7B,KAAK,CAAC,YAAY,CAAI,MAAI,yCAAQ,CAAC,CAAC;gBACpC,MAAM,CAAC,KAAK,CAAC;YACd,CAAC;YACD,IAAM,SAAS,GAAG,MAAI,GAAG,SAAS,CAAC;YACnC,EAAE,CAAC,CAAC,CAAC,CAAC,OAAO,IAAI,CAAC,CAAC,CAAC,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;gBACvC,IAAM,IAAI,GAAG,CAAC,CAAC,UAAU,CAAC;gBAC1B,KAAK,CAAC,YAAY,CAAC,MAAG,IAAI,CAAC,CAAC,CAAC,SAAS,GAAG,IAAI,CAAC,CAAC,CAAC,SAAS,CAAE,CAAC,CAAC;gBAC7D,MAAM,CAAC,KAAK,CAAC;YACd,CAAC;YACD,QAAQ,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,GAAG,CAAC;SACvB;QACD,MAAM,CAAC,QAAQ,CAAC;IACjB,CAAC;IACD,mBAAmB,SAAS;QAC3B,OAAO,EAAE,CAAC,OAAO,CAAC,WAAC;YAClB,IAAM,EAAE,GAAG,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;YAChC,EAAE,CAAC,CAAC,CAAC,CAAC,IAAI,KAAK,eAAe,CAAC,CAAC,CAAC;gBAChC,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;YACpC,CAAC;YAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,IAAI,KAAK,MAAM,CAAC,CAAC,CAAC;gBAC9B,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;YACjC,CAAC;YAAC,IAAI,CAAC,CAAC;gBACP,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;YACZ,CAAC;QACF,CAAC,CAAC,CAAC;IACJ,CAAC;AACF,CAAC,EAhQS,8BAA8B,KAA9B,8BAA8B,QAgQvC","file":"68.js","sourcesContent":["// import 'select2/dist/css/select2.css';\r\nimport * as utils from 'utils';\r\nimport 'new-table';\r\nimport * as tables from 'tables';\r\n// import 'script-loader!select2/dist/js/select2.full.min.js';\r\nimport 'select';\r\n\r\nnamespace SuperadminFieldDictionaryIndex {\r\n\tenum action {\r\n\t\tadd,\r\n\t\tupdate\r\n\t}\r\n\tlet state: action;\r\n\tdeclare const types;// 权限\r\n\tdeclare const visibles;// 文档类型\r\n\t$(initTable);\r\n\tfunction initTable() {\r\n\t\tconst $type = $('.type');\r\n\t\tconst $visible = $('.visible');\r\n\t\t$type.select2({\r\n\t\t\tdata: types,\r\n\t\t\tplaceholder: '选择类型',\r\n\t\t\tallowClear: true\r\n\t\t});\r\n\t\t$type.val('').trigger('change');\r\n\t\t$visible.select2({\r\n\t\t\tval: '全员可见',\r\n\t\t\tdata: visibles,\r\n\t\t\tplaceholder: '选择可见度',\r\n\t\t\tallowClear: true\r\n\t\t} as any);\r\n\t\t$visible.val('999').trigger('change');\r\n\t\t$('#table').DataTable(Object.assign(tables.commonConfig(),\r\n\t\t\t{\r\n\t\t\t\tajax: {\r\n\t\t\t\t\turl: 'superadmin/fieldDictionary/list',\r\n\t\t\t\t\ttype: 'POST',\r\n\t\t\t\t\tdataSrc: data => data.rows,\r\n\t\t\t\t\tdata: data => {\r\n\t\t\t\t\t\treturn utils.cleanObject({\r\n\t\t\t\t\t\t\tpage: tables.getPage(data),\r\n\t\t\t\t\t\t\trows: data.length,\r\n\t\t\t\t\t\t\tname: $('#name').val(),\r\n\t\t\t\t\t\t\ttype: $('#type option:selected').text(),\r\n\t\t\t\t\t\t\tcode: $('#code').val(),\r\n\t\t\t\t\t\t\tvisible_level: $('#visibleLevel option:selected').val()\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tcolumns: [\r\n\t\t\t\t\t{ data: 'type', title: '类型' },\r\n\t\t\t\t\t{ data: 'name', title: '名称' },\r\n\t\t\t\t\t{ data: 'code', title: 'code值' },\r\n\t\t\t\t\t{ data: 'description', title: '描述' },\r\n\t\t\t\t\t{ data: 'visibleLevel', title: '可见度', render: renderVisible }\r\n\t\t\t\t],\r\n\t\t\t\tinitComplete: initComplete\r\n\t\t\t}\r\n\t\t));\r\n\t\tfunction renderVisible(text) {\r\n\t\t\tlet visibleName;\r\n\t\t\tvisibles.forEach(v => {\r\n\t\t\t\tif (v.id === text) {\r\n\t\t\t\t\tvisibleName = v.text;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn visibleName;\r\n\t\t}\r\n\t}\r\n\tfunction initComplete() {\r\n\t\tconst table = $('#table').DataTable();\r\n\t\tutils.bindEnter($('#name,#type,#code'), () => {\r\n\t\t\ttable.draw();\r\n\t\t});\r\n\t\t// 查询功能\r\n\t\t$('#dictionary-search-btn').on('click', () => {\r\n\t\t\ttable.draw();\r\n\t\t});\r\n\t\ttables.bindPageChange(table); // 绑定修改分页\r\n\t\t// 添加功能\r\n\t\tconst modalRoot = $('.dictionary');\r\n\t\t$('#dictionary-add-btn').on('click', () => {\r\n\t\t\tstate = action.add;\r\n\t\t\tmodalRoot.find('button.submit-btn').html('添加');\r\n\t\t\tmodalRoot.modal('show').find('h4.modal-title').text('添加数据字典');\r\n\t\t\tclearData(modalRoot);\r\n\t\t});\r\n\t\t// 编辑功能\r\n\t\tlet dicid: number;\r\n\t\t$('#dictionary-edit-btn').on('click', () => {\r\n\t\t\tstate = action.update;\r\n\t\t\ttables.checkLength({\r\n\t\t\t\taction: '修改',\r\n\t\t\t\tname: '数据字典',\r\n\t\t\t\tunique: true,\r\n\t\t\t\ttable: table,\r\n\t\t\t\tcb: (data) => {\r\n\t\t\t\t\tdicid = data.id;\r\n\t\t\t\t\tgetData().forEach(v => {\r\n\t\t\t\t\t\tconst el = modalRoot.find(v.el);\r\n\t\t\t\t\t\tif (v.name === 'visible_level') {\r\n\t\t\t\t\t\t\t$(el).val(data.visibleLevel).trigger('change');\r\n\t\t\t\t\t\t} else if (v.name === 'type') {\r\n\t\t\t\t\t\t\t// 遍历类型对象\r\n\t\t\t\t\t\t\ttypes.forEach(t => {\r\n\t\t\t\t\t\t\t\tif (t.text === data[v.name]) {\r\n\t\t\t\t\t\t\t\t\t$(el).val(t.id).trigger('change');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tel.val(data[v.name]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tmodalRoot.find('button.submit-btn').html('保存');\r\n\t\t\t\t\tmodalRoot.modal('show').find('h4.modal-title').text('修改数据字典');\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t\t// 确定按钮\r\n\t\t$('.submit-btn').on('click', () => {\r\n\t\t\tif (state === action.add) {\r\n\t\t\t\taddSubEvent();\r\n\t\t\t} else if (state === action.update) {\r\n\t\t\t\teditSubEvent();\r\n\t\t\t}\r\n\t\t});\r\n\t\t// 删除功能\r\n\t\ttables.delBtnClick({\r\n\t\t\tel: $('#dictionary-del-btn'),\r\n\t\t\ttable: table,\r\n\t\t\tname: '数据字典',\r\n\t\t\turl: 'superadmin/fieldDictionary/delete'\r\n\t\t});\r\n\r\n\t\tfunction addSubEvent() {\r\n\t\t\tconst endLoading = utils.loadingBtn($(this));\r\n\t\t\tconst ajaxData: any = validator(modalRoot, 'add');\r\n\t\t\tajaxData.code = parseInt(ajaxData.code);\r\n\t\t\tif (ajaxData) {\r\n\t\t\t\t$.ajax({\r\n\t\t\t\t\turl: 'superadmin/fieldDictionary/add',\r\n\t\t\t\t\ttype: 'POST',\r\n\t\t\t\t\tdata: ajaxData,\r\n\t\t\t\t\tsuccess: msg => {\r\n\t\t\t\t\t\tif (!msg.error) {\r\n\t\t\t\t\t\t\ttable.draw();\r\n\t\t\t\t\t\t\tmodalRoot.modal('hide');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tutils.alertMessage(msg.msg, !msg.error);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tendLoading();\r\n\t\t}\r\n\t\tfunction editSubEvent() {\r\n\t\t\tconst endLoading = utils.loadingBtn($(this));\r\n\t\t\tconst ajaxData = validator(modalRoot, 'edit');\r\n\t\t\tObject.assign(ajaxData, { id: dicid });\r\n\t\t\tif (ajaxData) {\r\n\t\t\t\t$.ajax({\r\n\t\t\t\t\turl: 'superadmin/fieldDictionary/update',\r\n\t\t\t\t\ttype: 'POST',\r\n\t\t\t\t\tdata: ajaxData,\r\n\t\t\t\t\tsuccess: msg => {\r\n\t\t\t\t\t\tif (!msg.error) {\r\n\t\t\t\t\t\t\ttable.draw();\r\n\t\t\t\t\t\t\tmodalRoot.modal('hide');\r\n\t\t\t\t\t\t\tclearData(modalRoot);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tutils.alertMessage(msg.msg, !msg.error);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tendLoading();\r\n\t\t}\r\n\t}\r\n\tfunction getData(filter?: string) {\r\n\t\tconst data = [\r\n\t\t\t{\r\n\t\t\t\tname: 'type',\r\n\t\t\t\tel: '.type',\r\n\t\t\t\trequire: true\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tname: 'name',\r\n\t\t\t\tel: '.name',\r\n\t\t\t\trequire: true\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tname: 'code',\r\n\t\t\t\tel: '.code',\r\n\t\t\t\trequire: true,\r\n\t\t\t\tpattern: /^[-+]?[0-9]+$/,\r\n\t\t\t\tpatternMsg: '（须为整数类型）！'\r\n\t\t\t}, {\r\n\t\t\t\tname: 'description',\r\n\t\t\t\tel: '.description',\r\n\t\t\t\trequire: false\r\n\t\t\t}, {\r\n\t\t\t\tname: 'visible_level',\r\n\t\t\t\tel: '.visible_level',\r\n\t\t\t\trequire: true\r\n\t\t\t}\r\n\t\t];\r\n\t\tif (filter) {\r\n\t\t\tconst d = [];\r\n\t\t\tdata.forEach(v => {\r\n\t\t\t\tif (filter !== v.el) {\r\n\t\t\t\t\td.push(v);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn d;\r\n\t\t}\r\n\t\treturn data;\r\n\t}\r\n\tfunction validator(el, msg) {\r\n\t\tlet currentData = [];\r\n\t\tif (msg === 'add') {\r\n\t\t\tcurrentData = getData();\r\n\t\t} else if (msg === 'edit') {\r\n\t\t\tcurrentData = getData();\r\n\t\t}\r\n\t\tlet ajaxData = {};\r\n\t\tfor (let v of currentData) {\r\n\t\t\tlet val;\r\n\t\t\tlet name;\r\n\t\t\tif (v.name === 'type') {\r\n\t\t\t\tval = el.find('.type option:selected').text();\r\n\t\t\t\tname = '类型';\r\n\t\t\t} else if (v.name === 'visible_level') {\r\n\t\t\t\tval = el.find('.visible option:selected').val();\r\n\t\t\t\tname = '可见度';\r\n\t\t\t} else {\r\n\t\t\t\tconst input = el.find(v.el);\r\n\t\t\t\tval = $.trim(input.val());\r\n\t\t\t\tname = input.parent().prev().text();\r\n\t\t\t}\r\n\t\t\tif (v.require && val === '') {\r\n\t\t\t\tutils.alertMessage(`${name}的值不能为空`);\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tconst misFormat = name + '的格式不正确！';\r\n\t\t\tif (v.pattern && !v.pattern.test(val)) {\r\n\t\t\t\tconst pmsg = v.patternMsg;\r\n\t\t\t\tutils.alertMessage(`${pmsg ? misFormat + pmsg : misFormat}`);\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tajaxData[v.name] = val;\r\n\t\t}\r\n\t\treturn ajaxData;\r\n\t}\r\n\tfunction clearData(modalRoot) {\r\n\t\tgetData().forEach(v => {\r\n\t\t\tconst el = modalRoot.find(v.el);\r\n\t\t\tif (v.name === 'visible_level') {\r\n\t\t\t\t$(el).val('999').trigger('change');\r\n\t\t\t} else if (v.name === 'type') {\r\n\t\t\t\t$(el).val('').trigger('change');\r\n\t\t\t} else {\r\n\t\t\t\tel.val('');\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./pages/superadmin/fieldDictionary/index/index.ts"],"sourceRoot":""}