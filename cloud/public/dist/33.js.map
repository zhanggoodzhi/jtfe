{"version":3,"sources":["webpack:///./pages/weixinv2/enterprise/app/index/index.ts","webpack:///./pages/weixinv2/enterprise/app/index/index.less"],"names":[],"mappings":"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","file":"33.js","sourcesContent":["import './index.less';\r\nimport 'new-table';\r\nimport * as tables from 'tables';\r\nimport * as utils from 'utils';\r\nimport 'select';\r\nnamespace Weixinv2EnterpriseApp {\r\n\tlet table: DataTables.Api;\r\n\tlet t: tables.Table;\r\n\tlet $table: JQuery;\r\n\tlet mActionState: any;\r\n\tlet eSendData: any = {};\r\n\tlet modalRoot: any;\r\n\tdeclare const agentList;\r\n\t$(() => {\r\n\t\tinitSelect();\r\n\t\tinitTable();\r\n\t});\r\n\tfunction initSelect() {\r\n\t\tconst $agentList = $('.agentid');\r\n\t\t$agentList.select2({\r\n\t\t\tdata: agentList,\r\n\t\t\tplaceholder: '请选择企业号管理组',\r\n\t\t\tmultiple: true\r\n\t\t});\r\n\t\t$agentList.val('').trigger('change');\r\n\t}\r\n    /**\r\n     * 初始化表格\r\n     */\r\n\tfunction initTable() {\r\n\t\t$table = $('#enterprise-app-table');\r\n\t\ttable = $table.DataTable(\r\n\t\t\tObject.assign(\r\n\t\t\t\ttables.commonConfig(),\r\n\t\t\t\t{\r\n\t\t\t\t\tselect: false,\r\n\t\t\t\t\tajax: {\r\n\t\t\t\t\t\turl: 'weixinv2/enterprise/app/list',\r\n\t\t\t\t\t\ttype: 'GET',\r\n\t\t\t\t\t\tdataSrc: data => data.rows,\r\n\t\t\t\t\t\tdata: (data) => {\r\n\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\tpage: Math.floor((data.start + data.length) / data.length),\r\n\t\t\t\t\t\t\t\trows: data.length\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tinitComplete: initComplete,\r\n\t\t\t\t\tcolumns: [\r\n\t\t\t\t\t\t// { name: 'round_logo_url', data: 'round_logo_url', title: '应用LOG',render:renderLog},\r\n\t\t\t\t\t\t{ name: 'name', data: 'name', width: '20%', title: '应用名称'/*, createdCell: tables.createAddTitle */ },\r\n\t\t\t\t\t\t{ name: 'agentid', data: 'agentid', width: '20%', title: '应用ID', createdCell: tables.createAddTitle },\r\n\t\t\t\t\t\t{ data: 'credentialName', title: '', 'orderable': false, width: tables.VARIABLES.width.icon, className: 'show-g-corpus force-width prevent', createdCell: createShowCorpus/*, render: renderShowCorpus*/ },\r\n\t\t\t\t\t\t{ name: 'credentialName', data: 'credentialName', title: '管理组'/*, createdCell: tables.createAddTitle*/, render: renderAgents },\r\n\t\t\t\t\t\t{ name: 'action', title: '操作', render: renderBtns }\r\n\t\t\t\t\t]\r\n\t\t\t\t}\r\n\t\t\t)\r\n\t\t);\r\n\t\tt = new tables.Table(table);\r\n\t}\r\n    /*function renderLog(data){\r\n        return `<img src=${data} class='logIamge' style=\"background-image: url('${data}');\"/>`;\r\n    }*/\r\n\tfunction renderAgents(data) {\r\n\t\treturn data[0];\r\n\t}\r\n\tfunction renderBtns(data, type, row) {\r\n\t\treturn `<div class=\"row-input\" data-d=' + ${row} + '><a style=\"padding-left:0;\" class=\"btn btn-link btn-sm enterprise-app-del\">删除</a><a class=\"btn btn-link btn-sm enterprise-app-edit\">编辑</a></div>`;\r\n\t}\r\n\tfunction createShowCorpus(td: HTMLElement, cellDatA, rowData) {\r\n\t\tconst el = $(td);\r\n\t\tif (cellDatA.length > 1) {\r\n\t\t\tel\r\n\t\t\t\t.addClass('show-corpus-td')\r\n\t\t\t\t.data('agentNames', cellDatA)\r\n\t\t\t\t.icon();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tel.addClass('disabled')\r\n\t\t\t\t.icon();\r\n\t\t}\r\n\t}\r\n\tfunction initComplete() {\r\n\t\tmodalRoot = $('#addEnterpriseApp');\r\n\t\tmodalRoot.on('hidden.bs.modal', clearModal);\r\n\t\ttables.bindPageChange(table, $('#page-change'));\r\n\t\t// 添加应用\r\n\t\t$('#addEnterpriseAppBtn').on('click', () => {\r\n\t\t\tmActionState = 'create';\r\n\t\t\tmodalRoot.modal('show').find('h4.modal-title').text('添加应用');\r\n\t\t});\r\n\t\t// 修改应用\r\n\t\t$table.on('click', '.enterprise-app-edit', editEnterpriseApp);\r\n\t\t// 保存\r\n\t\tmodalRoot.on('click', '#submit', saveEnterpriseApp);\r\n\t\t// 删除enterprise-app-del\r\n\t\t$table.on('click', '.enterprise-app-del', delEnterpriseApp);\r\n\t\t// 左侧加号点击\r\n\t\t$table.on('click', '.show-corpus-td.show-g-corpus', function (e) {\r\n\t\t\tshowCorpus(e);\r\n\t\t});\r\n\t}\r\n\tfunction showCorpus(e: JQueryEventObject) {\r\n\t\t// 符号切换\r\n\t\tconst el = $(e.currentTarget),\r\n\t\t\ttr = el.parents('tr'),\r\n\t\t\ticon = el.icon();\r\n\t\tswitch (icon.state) {\r\n\t\t\tcase utils.IconState.plus:\r\n\t\t\t\tconst trs = getTrs(el.data().agentNames, name);\r\n\t\t\t\ttr.after($(trs));\r\n\t\t\t\ticon.state = utils.IconState.minus;\r\n\t\t\t\treturn;\r\n\t\t\tcase utils.IconState.minus:\r\n\t\t\t\ticon.state = utils.IconState.plus;\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\treturn;\r\n\t\t}\r\n\t\tclearTable();\r\n\t}\r\n\t// 把子管理组名称遍历为行显示。\r\n\tfunction getTrs(data, name: string) {\r\n\t\tlet html = '';\r\n\t\tconst len = table.columns().indexes().length;\r\n\t\tif (!data || data.length <= 0) {\r\n\t\t\treturn `\r\n                <tr class=\"cps-details\">\r\n                    <td colspan=\"${len}\" class=\"text-center\">无数据</td>\r\n                </tr>`;\r\n\t\t}\r\n\t\tlet tempData = [];\r\n\t\tfor (let i = 0; i < data.length; i++) {\r\n\t\t\tif (i > 0) {\r\n\t\t\t\ttempData.push(data[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor (let v of tempData) {\r\n\t\t\thtml += ` <tr class=\"cps-details\">`;\r\n\t\t\tif (!v) {\r\n\t\t\t\thtml += `<td></td>`;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\thtml += `<td></td><td></td><td></td><td class=\"force-width\">${v}</td><td></td>`;\r\n\t\t\t}\r\n\t\t\thtml += `</tr>`;\r\n\t\t}\r\n\t\treturn html;\r\n\t}\r\n\t// 重置表格中减号变为加号\r\n\tfunction clearTable() {\r\n\t\t$('.cps-details').remove();\r\n\t\tresetIcon($('#table tbody .show-corpus-td'));\r\n\t}\r\n\tfunction resetIcon(element?: JQuery) {\r\n\t\tArray.prototype.forEach.call(element, v => {\r\n\t\t\tconst icon = $(v).icon();\r\n\t\t\tif (icon.state === utils.IconState.minus) {\r\n\t\t\t\ticon.state = utils.IconState.plus;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t// 删除\r\n\tfunction delEnterpriseApp(row) {\r\n\t\tconst el = $(this);\r\n\t\tconst eData: any = table.row(el.parents('tr')).data();\r\n\t\t$.ajax({\r\n\t\t\turl: 'weixinv2/enterprise/app/delete',\r\n\t\t\ttype: 'POST',\r\n\t\t\tdata: {\r\n\t\t\t\tid: eData.id\r\n\t\t\t},\r\n\t\t\tsuccess: function (data) {\r\n\t\t\t\tif (!data.error) {\r\n\t\t\t\t\tt.refresh(true);\r\n\t\t\t\t}\r\n\t\t\t\tutils.alertMessage(data.msg, !data.error);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t// 修改应用\r\n\tfunction editEnterpriseApp(row) {\r\n\t\tmActionState = 'edit';\r\n\t\tconst el = $(this);\r\n\t\tconst data: any = table.row(el.parents('tr')).data();\r\n\t\teSendData.id = data.id;\r\n\t\tlet pIds = [];\r\n\t\tagentList.forEach(v => {\r\n\t\t\tdata.credentialId.forEach(t => {\r\n\t\t\t\tif (v.id === t) {\r\n\t\t\t\t\tpIds.push(v.id);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t\t$(modalRoot.find('#agent')).val(pIds).trigger('change');\r\n\t\tmodalRoot.find('#wxEAppId').val(data.agentid);\r\n\t\tmodalRoot.find('#wxEAppId').attr('readonly', 'readonly');\r\n\t\tmodalRoot.modal('show').find('h4.modal-title').text('编辑应用');\r\n\t}\r\n\t// 清空模态框\r\n\tfunction clearModal() {\r\n\t\tconst el = $('#addEnterpriseApp');\r\n\t\tel.find('input[type=\"text\"]').val('');\r\n\t\tel.find('select').val('').trigger('change');\r\n\t\tel.find('#wxEAppId').removeAttr('readonly');\r\n\t\teSendData.id = null;\r\n\t}\r\n\t// 点击模态框中的确认\r\n\tfunction saveEnterpriseApp() {\r\n\t\tconst endLoading = utils.loadingBtn($('#submit'));\r\n\t\tlet url: any;\r\n\t\tlet sendData: any = {};\r\n\t\tsendData.credentialId = $('.agentid').val().join(',');\r\n\t\tif (mActionState === 'create') {\r\n\t\t\tsendData.agentid = $('#wxEAppId').val();\r\n\t\t\tif (!sendData.credentialId) {\r\n\t\t\t\tendLoading();\r\n\t\t\t\tutils.alertMessage('管理组不能为空！');\r\n\t\t\t\treturn;\r\n\t\t\t} else if (!sendData.agentid) {\r\n\t\t\t\tendLoading();\r\n\t\t\t\tutils.alertMessage('应用ID不能为空！');\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\turl = 'weixinv2/enterprise/app/getApplication';\r\n\t\t} else if (mActionState === 'edit') {\r\n\t\t\tif (!sendData.credentialId) {\r\n\t\t\t\tendLoading();\r\n\t\t\t\tutils.alertMessage('管理组不能为空！');\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\turl = 'weixinv2/enterprise/app/edit';\r\n\t\t\tsendData.id = eSendData.id;\r\n\t\t}\r\n\t\t$.ajax({\r\n\t\t\turl: url,\r\n\t\t\ttype: 'POST',\r\n\t\t\tdata: utils.cleanObject(sendData),\r\n\t\t\tsuccess: function (data) {\r\n\t\t\t\tif (!data.error) {\r\n\t\t\t\t\t$('#addEnterpriseApp').modal('hide');\r\n\t\t\t\t\tt.refresh(true);\r\n\t\t\t\t\tclearModal();\r\n\t\t\t\t}\r\n\t\t\t\tutils.alertMessage(data.msg, !data.error);\r\n\t\t\t},\r\n\t\t\tcomplete: () => { endLoading(); }\r\n\t\t});\r\n\t}\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./pages/weixinv2/enterprise/app/index/index.ts","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./pages/weixinv2/enterprise/app/index/index.less\n// module id = 966\n// module chunks = 33"],"sourceRoot":""}