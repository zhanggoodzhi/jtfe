{"version":3,"sources":["webpack:///./pages/user/app/role/index.ts","webpack:///./pages/user/app/role/index.less"],"names":[],"mappings":"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","file":"36.js","sourcesContent":["import './index.less';\r\nimport { Table } from 'new-table';\r\nimport * as utils from 'utils';\r\nnamespace UserAppIndex {\r\n\tlet roleTable;\r\n\tlet authTable;\r\n\tlet ifAdd = true;\r\n\tlet currentId = 0;\r\n\tlet selectRoleId = 0;\r\n\t$(function () {\r\n\t\tinit();\r\n\t});\r\n\r\n\tfunction init() {\r\n\t\tinitRoleTable();\r\n\t\tinitAuthTable();\r\n\t}\r\n\r\n\tfunction initRoleTable() {\r\n\t\troleTable = new Table(\r\n\t\t\t{\r\n\t\t\t\tel: $('#role-table'),\r\n\t\t\t\toptions: {\r\n\t\t\t\t\tpaging: false,\r\n\t\t\t\t\tinfo: false,\r\n\t\t\t\t\tserverSide: true,\r\n\t\t\t\t\tajax: {\r\n\t\t\t\t\t\ttype: 'POST',\r\n\t\t\t\t\t\turl: 'user/app/getRole',\r\n\t\t\t\t\t\tdataSrc: data => { return data.data; },\r\n\t\t\t\t\t\tdata: (d: any) => {\r\n\t\t\t\t\t\t\treturn {};\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\t// data: [{\r\n\t\t\t\t\t// \tid: '1',\r\n\t\t\t\t\t// \ttext: '管理员'\r\n\t\t\t\t\t// },\r\n\t\t\t\t\t// {\r\n\t\t\t\t\t// \tid: '2',\r\n\t\t\t\t\t// \ttext: '审核者'\r\n\t\t\t\t\t// }],\r\n\t\t\t\t\tinitComplete: bindRoleTableEvent,\r\n\t\t\t\t\tcolumns: [\r\n\t\t\t\t\t\t{ data: 'name' },\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tdata: 'id', className: 'prevent', width: '70', render: (id) => {\r\n\t\t\t\t\t\t\t\treturn `\r\n\t\t\t\t\t\t\t\t<i class=\"fa cloud-fa-icon fa-edit edit\" title=\"编辑\"></i>\r\n\t\t\t\t\t\t\t\t<i class=\"fa cloud-fa-icon fa-trash delete\" title=\"删除\"></i>\r\n\t\t\t\t\t\t\t\t`;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t]\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t}\r\n\tfunction bindRoleTableEvent() {\r\n\t\tconst tableEl = $('#role-table');\r\n\t\tconst modalEl = $('#role-modal');\r\n\t\ttableEl.DataTable().select.style('single');\r\n\t\t$('#add-btn').on('click', function () {\r\n\t\t\tifAdd = true;\r\n\t\t\t$('#role-modal').modal('show');\r\n\t\t});\r\n\t\tmodalEl.on('hidden.bs.modal', function () {\r\n\t\t\t$('#name').val(null);\r\n\t\t\t$('#role-modal .modal-title').text('添加角色');\r\n\t\t});\r\n\t\ttableEl.on('click', '.edit', function () {\r\n\t\t\t$('#role-modal .modal-title').text('编辑角色');\r\n\t\t\tifAdd = false;\r\n\t\t\tconst rowData = roleTable.dt.row($(this).closest('tr')).data();\r\n\t\t\tconst name = rowData.name;\r\n\t\t\tcurrentId = rowData.id;\r\n\t\t\t$('#name').val(name);\r\n\t\t\t$('#role-modal').modal('show');\r\n\t\t});\r\n\t\ttableEl.on('click', '.delete', function () {\r\n\t\t\tconst id = roleTable.dt.row($(this).closest('tr')).data().id;\r\n\t\t\tutils.confirmModal({\r\n\t\t\t\tmsg: '确认删除该角色么?',\r\n\t\t\t\tcb: (modal, btn) => {\r\n\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\turl: 'user/app/delRole',\r\n\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\troleId: id,\r\n\t\t\t\t\t\t\tflag: false\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tmethod: 'POST',\r\n\t\t\t\t\t\tsuccess: function (data) {\r\n\t\t\t\t\t\t\tif (data.state === 'success') {\r\n\t\t\t\t\t\t\t\tmodal.modal('hide');\r\n\t\t\t\t\t\t\t\troleTable.reload();\r\n\t\t\t\t\t\t\t\tutils.alertMessage('删除成功！', true);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if (data.state === 'fail_existUser') {\r\n\t\t\t\t\t\t\t\tmodal.modal('hide');\r\n\t\t\t\t\t\t\t\tutils.confirmModal({\r\n\t\t\t\t\t\t\t\t\tmsg: '存在用户使用该角色，是否继续删除?',\r\n\t\t\t\t\t\t\t\t\tcb: (smodal, sbtn) => {\r\n\t\t\t\t\t\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\t\t\t\t\t\turl: 'user/app/delRole',\r\n\t\t\t\t\t\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\t\t\t\t\t\troleId: id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tflag: true\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\tmethod: 'POST',\r\n\t\t\t\t\t\t\t\t\t\t\tsuccess: function (sdata) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (sdata.state === 'success') {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsmodal.modal('hide');\r\n\t\t\t\t\t\t\t\t\t\t\t\t\troleTable.reload();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tutils.alertMessage('删除成功！', true);\r\n\t\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tutils.alertMessage('删除失败！', false);\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tutils.alertMessage('删除失败！', false);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t\t$('#modal-save-btn').on('click', function () {\r\n\t\t\tconst name = $('#name').val();\r\n\t\t\tif (name === '') {\r\n\t\t\t\tutils.alertMessage('请输入角色名称!');\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t$.ajax('user/app/addRole', {\r\n\t\t\t\tmethod: 'POST',\r\n\t\t\t\tdata: {\r\n\t\t\t\t\tname,\r\n\t\t\t\t\tid: ifAdd ? 0 : currentId\r\n\t\t\t\t}\r\n\t\t\t}).done((data) => {\r\n\t\t\t\tif (data.state === 'success' || data.state === 'editsuccess') {\r\n\t\t\t\t\tutils.alertMessage(ifAdd ? '添加成功' : '编辑成功', true);\r\n\t\t\t\t\tmodalEl.modal('hide');\r\n\t\t\t\t\troleTable.reload();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tutils.alertMessage(data.msg);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t\ttableEl.DataTable().on('select', function (e, dt, type, indexes) {\r\n\t\t\tconst authDt = authTable.dt;\r\n\t\t\tconst rowData = roleTable.dt.row(indexes).data();\r\n\t\t\tconst id = rowData.id;\r\n\t\t\tselectRoleId = id;\r\n\t\t\t$.ajax('user/app/showPri', {\r\n\t\t\t\tmethod: 'POST',\r\n\t\t\t\tdata: {\r\n\t\t\t\t\tid\r\n\t\t\t\t}\r\n\t\t\t}).done((data) => {\r\n\t\t\t\tif (data.state === 'success') {\r\n\t\t\t\t\tconst arr = data.msg.split(',');\r\n\t\t\t\t\tarr.forEach(v => {\r\n\t\t\t\t\t\tauthDt.row((i, row) => {\r\n\t\t\t\t\t\t\tif (row.id.toString() === v) {\r\n\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}).select();\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tauthDt.rows().deselect();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t\ttableEl.DataTable().on('deselect', (e, dt) => {\r\n\t\t\tconst authDt = authTable.dt;\r\n\t\t\tauthDt.rows().deselect();\r\n\t\t});\r\n\t}\r\n\tfunction initAuthTable() {\r\n\t\tauthTable = new Table(\r\n\t\t\t{\r\n\t\t\t\tel: $('#auth-table'),\r\n\t\t\t\tcheckbox: {\r\n\t\t\t\t\tdata: 'id'\r\n\t\t\t\t},\r\n\t\t\t\toptions: {\r\n\t\t\t\t\tselect: {\r\n\t\t\t\t\t\tstyle: 'api',\r\n\t\t\t\t\t\tblurable: false,\r\n\t\t\t\t\t\tinfo: false,\r\n\t\t\t\t\t\tselector: 'tr td:not(.prevent)'\r\n\t\t\t\t\t},\r\n\t\t\t\t\tpaging: false,\r\n\t\t\t\t\tinfo: false,\r\n\t\t\t\t\tserverSide: true,\r\n\t\t\t\t\tajax: {\r\n\t\t\t\t\t\ttype: 'POST',\r\n\t\t\t\t\t\turl: 'user/app/getPrivileges',\r\n\t\t\t\t\t\tdataSrc: data => { return data.data; },\r\n\t\t\t\t\t\tdata: (d: any) => {\r\n\t\t\t\t\t\t\treturn {};\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\t// data: [{\r\n\t\t\t\t\t// \tid: '1',\r\n\t\t\t\t\t// \ttext: '权限1'\r\n\t\t\t\t\t// },\r\n\t\t\t\t\t// {\r\n\t\t\t\t\t// \tid: '2',\r\n\t\t\t\t\t// \ttext: '权限2'\r\n\t\t\t\t\t// }],\r\n\t\t\t\t\tinitComplete: bindAuthTableEvent,\r\n\t\t\t\t\tcolumns: [\r\n\t\t\t\t\t\t{ data: 'desc', title: '全选' }\r\n\t\t\t\t\t]\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t}\r\n\tfunction turnEdit() {\r\n\t\t$('#auth-table').DataTable().select.style('multi');\r\n\t\t$('#edit-btn').hide();\r\n\t\t$('#save-btn').show();\r\n\t\t$('.disabled-wrap').show();\r\n\t\t$('#auth-table tr').removeClass('disable');\r\n\t\t$('#auth-table_wrapper .dataTables_scrollHead').addClass('show');\r\n\t}\r\n\tfunction turnCheck() {\r\n\t\t$('#auth-table').DataTable().select.style('api');\r\n\t\t$('#save-btn').hide();\r\n\t\t$('#edit-btn').show();\r\n\t\t$('.disabled-wrap').hide();\r\n\t\t$('#auth-table tr').addClass('disable');\r\n\t\t$('#auth-table_wrapper .dataTables_scrollHead').removeClass('show');\r\n\t}\r\n\tfunction bindAuthTableEvent() {\r\n\t\t$('#auth-table tr').addClass('disable');\r\n\t\t$('#edit-btn').on('click', function () {\r\n\t\t\tif (Array.from(roleTable.dt.rows('.selected').data()).length === 0) {\r\n\t\t\t\tutils.alertMessage('请先选择一个角色！');\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tturnEdit();\r\n\t\t});\r\n\t\t$('#save-btn').on('click', function () {\r\n\t\t\tconst selects = Array.from(authTable.dt.rows('.selected').data()) as any;\r\n\t\t\tconst ids = selects.map(v => {\r\n\t\t\t\treturn v.id;\r\n\t\t\t});\r\n\t\t\t$.ajax('user/app/editPri', {\r\n\t\t\t\tmethod: 'POST',\r\n\t\t\t\tdata: {\r\n\t\t\t\t\troleid: selectRoleId,\r\n\t\t\t\t\tpris: ids.join(',')\r\n\t\t\t\t}\r\n\t\t\t}).done((data) => {\r\n\t\t\t\tif (data.state === 'add' || data.state === 'success' || data.state === 'delete') {\r\n\t\t\t\t\tutils.alertMessage('编辑权限成功', true);\r\n\t\t\t\t\tturnCheck();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tutils.alertMessage(data.msg);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./pages/user/app/role/index.ts","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./pages/user/app/role/index.less\n// module id = 961\n// module chunks = 36"],"sourceRoot":""}